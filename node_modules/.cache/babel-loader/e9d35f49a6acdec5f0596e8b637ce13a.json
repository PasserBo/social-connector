{"ast":null,"code":"// ** React Imports\nimport{Fragment,useState}from'react';// ** Custom Components\nimport ExtensionsHeader from'@components/extensions-header';// ** Reactstrap Imports\nimport{Row,Col,Card,Table,Modal,Input,Label,Button,CardBody,ModalBody,ModalHeader,ModalFooter}from'reactstrap';// ** Third Party Components\nimport XLSX from'xlsx';import classnames from'classnames';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const initialData=[{id:1,name:'Leanne Graham',username:'Bret',email:'Sincere@april.biz',website:'hildegard.org'},{id:2,name:'Ervin Howell',username:'Antonette',email:'Shanna@melissa.tv',website:'anastasia.net'},{id:3,name:'Clementine Bauch',username:'Samantha',email:'Nathan@yesenia.net',website:'ramiro.info'},{id:4,name:'Patricia Lebsack',username:'Karianne',email:'Julianne.OConner@kory.org',website:'kale.biz'},{id:5,name:'Chelsey Dietrich',username:'Kamren',email:'Lucio_Hettinger@annie.ca',website:'demarco.info'},{id:6,name:'Mrs. Dennis Schulist',username:'Leopoldo_Corkery',email:'Karley_Dach@jasper.info',website:'ola.org'},{id:7,name:'Kurtis Weissnat',username:'Elwyn.Skiles',email:'Telly.Hoeger@billy.biz',website:'elvis.io'},{id:8,name:'Nicholas Runolfsdottir V',username:'Maxime_Nienow',email:'Sherwood@rosamond.me',website:'jacynthe.com'},{id:9,name:'Glenna Reichert',username:'Delphine',email:'Chaim_McDermott@dana.io',website:'conrad.com'},{id:10,name:'Clementina DuBuque',username:'Moriah.Stanton',email:'Rey.Padberg@karina.biz',website:'ambrose.net'}];const ExportSelected=()=>{// ** States\nconst[data]=useState(initialData);const[value,setValue]=useState('');const[modal,setModal]=useState(false);const[fileName,setFileName]=useState('');const[filteredData,setFilteredData]=useState([]);const[dataToExport,setDataToExport]=useState([]);const[fileFormat,setFileFormat]=useState('xlsx');const[selectedRows,setSelectedRows]=useState([]);const toggleModal=()=>setModal(!modal);const handleFilter=e=>{let filteredData=[];const value=e.target.value;setValue(value);if(value.length){filteredData=data.filter(col=>{const startsWithCondition=col.name.toLowerCase().startsWith(value.toLowerCase())||col.email.toLowerCase().startsWith(value.toLowerCase())||col.website.toLowerCase().startsWith(value.toLowerCase())||col.id.toString().toLowerCase().startsWith(value.toLowerCase());const includesCondition=col.name.toLowerCase().includes(value.toLowerCase())||col.email.toLowerCase().includes(value.toLowerCase())||col.website.toLowerCase().includes(value.toLowerCase())||col.id.toString().toLowerCase().includes(value.toLowerCase());if(startsWithCondition)return startsWithCondition;else if(!startsWithCondition&&includesCondition)return includesCondition;else return null;});setValue(value);setFilteredData(filteredData);}};const handleExport=()=>{const exportArr=dataToExport;data.map(item=>{if(selectedRows.includes(item.id)){return exportArr.push(item);}else{return null;}});setDataToExport([...exportArr]);const name=fileName.length?\"\".concat(fileName,\".\").concat(fileFormat):\"excel-sheet.\".concat(fileFormat);const wb=XLSX.utils.json_to_sheet(dataToExport);const wbout=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wbout,wb,'test');XLSX.writeFile(wbout,name);toggleModal();};const handleSelect=id=>{const selectedRowsArr=selectedRows;if(!selectedRowsArr.includes(id)){selectedRowsArr.push(id);}else if(selectedRowsArr.includes(id)){selectedRowsArr.splice(selectedRowsArr.indexOf(id),1);}else{return null;}setSelectedRows([...selectedRowsArr]);};const handleSelectAll=()=>{let selectedRowsArr=selectedRows;if(selectedRowsArr.length<data.length){const ids=data.map(i=>i.id);selectedRowsArr=ids;}else if(selectedRowsArr.length===data.length){selectedRowsArr=[];}else{return null;}setSelectedRows(selectedRowsArr);};const array=value?filteredData:data;const renderTableData=array.map(col=>{return/*#__PURE__*/_jsxs(\"tr\",{className:classnames({selected:selectedRows.includes(col.id)}),children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"form-check\",children:/*#__PURE__*/_jsx(Input,{id:col.id,type:\"checkbox\",onChange:()=>handleSelect(col.id),checked:!!selectedRows.includes(col.id)})})}),/*#__PURE__*/_jsx(\"td\",{children:col.email}),/*#__PURE__*/_jsx(\"td\",{children:col.name}),/*#__PURE__*/_jsx(\"td\",{children:col.website}),/*#__PURE__*/_jsx(\"td\",{children:col.id})]},col.id);});return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(ExtensionsHeader,{title:\"XLSX\",subTitle:\"Xlsx is a parser and writer for various spreadsheet formats\",link:\"https://github.com/SheetJS/sheetjs\"}),/*#__PURE__*/_jsx(Row,{className:\"export-component\",children:/*#__PURE__*/_jsx(Col,{sm:\"12\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardBody,{className:\"pb-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-wrap justify-content-between\",children:[/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:()=>toggleModal(),children:\"Export Selected\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-end\",children:[/*#__PURE__*/_jsx(Label,{for:\"search-input\",className:\"me-1\",children:\"Search\"}),/*#__PURE__*/_jsx(Input,{id:\"search-input\",bsSize:\"sm\",type:\"text\",value:value,onChange:e=>handleFilter(e)})]})]})}),/*#__PURE__*/_jsxs(Table,{className:\"table-hover-animation mt-2\",responsive:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"form-check\",children:/*#__PURE__*/_jsx(Input,{type:\"checkbox\",id:\"select-all\",label:\"\",checked:!!selectedRows.length,onChange:()=>handleSelectAll()})})}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Website\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Rank\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:renderTableData})]})]})})}),/*#__PURE__*/_jsxs(Modal,{isOpen:modal,toggle:()=>toggleModal(),className:\"modal-dialog-centered\",onClosed:()=>setFileName(''),children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:()=>toggleModal(),children:\"Export To Excel\"}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(Input,{type:\"text\",value:fileName,onChange:e=>setFileName(e.target.value),placeholder:\"Enter File Name\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Input,{type:\"select\",id:\"selectFileFormat\",name:\"customSelect\",value:fileFormat,onChange:e=>{setFileFormat(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{children:\"xlsx\"}),/*#__PURE__*/_jsx(\"option\",{children:\"csv\"}),/*#__PURE__*/_jsx(\"option\",{children:\"txt\"})]})})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:()=>handleExport(),children:\"Export\"}),/*#__PURE__*/_jsx(Button,{color:\"flat-danger\",onClick:()=>toggleModal(),children:\"Cancel\"})]})]})]});};export default ExportSelected;","map":{"version":3,"sources":["/Users/jvledesma/Downloads/bitfari-dev/www/src/views/extensions/import-export/ExportSelected.js"],"names":["Fragment","useState","ExtensionsHeader","Row","Col","Card","Table","Modal","Input","Label","Button","CardBody","ModalBody","ModalHeader","ModalFooter","XLSX","classnames","initialData","id","name","username","email","website","ExportSelected","data","value","setValue","modal","setModal","fileName","setFileName","filteredData","setFilteredData","dataToExport","setDataToExport","fileFormat","setFileFormat","selectedRows","setSelectedRows","toggleModal","handleFilter","e","target","length","filter","col","startsWithCondition","toLowerCase","startsWith","toString","includesCondition","includes","handleExport","exportArr","map","item","push","wb","utils","json_to_sheet","wbout","book_new","book_append_sheet","writeFile","handleSelect","selectedRowsArr","splice","indexOf","handleSelectAll","ids","i","array","renderTableData","selected"],"mappings":"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","sourcesContent":["// ** React Imports\r\nimport { Fragment, useState } from 'react'\r\n\r\n// ** Custom Components\r\nimport ExtensionsHeader from '@components/extensions-header'\r\n\r\n// ** Reactstrap Imports\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  Table,\r\n  Modal,\r\n  Input,\r\n  Label,\r\n  Button,\r\n  CardBody,\r\n  ModalBody,\r\n  ModalHeader,\r\n  ModalFooter\r\n} from 'reactstrap'\r\n\r\n// ** Third Party Components\r\nimport XLSX from 'xlsx'\r\nimport classnames from 'classnames'\r\n\r\nconst initialData = [\r\n  {\r\n    id: 1,\r\n    name: 'Leanne Graham',\r\n    username: 'Bret',\r\n    email: 'Sincere@april.biz',\r\n    website: 'hildegard.org'\r\n  },\r\n  {\r\n    id: 2,\r\n    name: 'Ervin Howell',\r\n    username: 'Antonette',\r\n    email: 'Shanna@melissa.tv',\r\n    website: 'anastasia.net'\r\n  },\r\n  {\r\n    id: 3,\r\n    name: 'Clementine Bauch',\r\n    username: 'Samantha',\r\n    email: 'Nathan@yesenia.net',\r\n    website: 'ramiro.info'\r\n  },\r\n  {\r\n    id: 4,\r\n    name: 'Patricia Lebsack',\r\n    username: 'Karianne',\r\n    email: 'Julianne.OConner@kory.org',\r\n    website: 'kale.biz'\r\n  },\r\n  {\r\n    id: 5,\r\n    name: 'Chelsey Dietrich',\r\n    username: 'Kamren',\r\n    email: 'Lucio_Hettinger@annie.ca',\r\n    website: 'demarco.info'\r\n  },\r\n  {\r\n    id: 6,\r\n    name: 'Mrs. Dennis Schulist',\r\n    username: 'Leopoldo_Corkery',\r\n    email: 'Karley_Dach@jasper.info',\r\n    website: 'ola.org'\r\n  },\r\n  {\r\n    id: 7,\r\n    name: 'Kurtis Weissnat',\r\n    username: 'Elwyn.Skiles',\r\n    email: 'Telly.Hoeger@billy.biz',\r\n    website: 'elvis.io'\r\n  },\r\n  {\r\n    id: 8,\r\n    name: 'Nicholas Runolfsdottir V',\r\n    username: 'Maxime_Nienow',\r\n    email: 'Sherwood@rosamond.me',\r\n    website: 'jacynthe.com'\r\n  },\r\n  {\r\n    id: 9,\r\n    name: 'Glenna Reichert',\r\n    username: 'Delphine',\r\n    email: 'Chaim_McDermott@dana.io',\r\n    website: 'conrad.com'\r\n  },\r\n  {\r\n    id: 10,\r\n    name: 'Clementina DuBuque',\r\n    username: 'Moriah.Stanton',\r\n    email: 'Rey.Padberg@karina.biz',\r\n    website: 'ambrose.net'\r\n  }\r\n]\r\n\r\nconst ExportSelected = () => {\r\n  // ** States\r\n  const [data] = useState(initialData)\r\n  const [value, setValue] = useState('')\r\n  const [modal, setModal] = useState(false)\r\n  const [fileName, setFileName] = useState('')\r\n  const [filteredData, setFilteredData] = useState([])\r\n  const [dataToExport, setDataToExport] = useState([])\r\n  const [fileFormat, setFileFormat] = useState('xlsx')\r\n  const [selectedRows, setSelectedRows] = useState([])\r\n\r\n  const toggleModal = () => setModal(!modal)\r\n\r\n  const handleFilter = e => {\r\n    let filteredData = []\r\n    const value = e.target.value\r\n    setValue(value)\r\n    if (value.length) {\r\n      filteredData = data.filter(col => {\r\n        const startsWithCondition =\r\n          col.name.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.email.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.website.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.id.toString().toLowerCase().startsWith(value.toLowerCase())\r\n\r\n        const includesCondition =\r\n          col.name.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.email.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.website.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.id.toString().toLowerCase().includes(value.toLowerCase())\r\n\r\n        if (startsWithCondition) return startsWithCondition\r\n        else if (!startsWithCondition && includesCondition) return includesCondition\r\n        else return null\r\n      })\r\n      setValue(value)\r\n      setFilteredData(filteredData)\r\n    }\r\n  }\r\n\r\n  const handleExport = () => {\r\n    const exportArr = dataToExport\r\n    data.map(item => {\r\n      if (selectedRows.includes(item.id)) {\r\n        return exportArr.push(item)\r\n      } else {\r\n        return null\r\n      }\r\n    })\r\n    setDataToExport([...exportArr])\r\n    const name = fileName.length ? `${fileName}.${fileFormat}` : `excel-sheet.${fileFormat}`\r\n    const wb = XLSX.utils.json_to_sheet(dataToExport)\r\n    const wbout = XLSX.utils.book_new()\r\n    XLSX.utils.book_append_sheet(wbout, wb, 'test')\r\n    XLSX.writeFile(wbout, name)\r\n    toggleModal()\r\n  }\r\n\r\n  const handleSelect = id => {\r\n    const selectedRowsArr = selectedRows\r\n    if (!selectedRowsArr.includes(id)) {\r\n      selectedRowsArr.push(id)\r\n    } else if (selectedRowsArr.includes(id)) {\r\n      selectedRowsArr.splice(selectedRowsArr.indexOf(id), 1)\r\n    } else {\r\n      return null\r\n    }\r\n    setSelectedRows([...selectedRowsArr])\r\n  }\r\n\r\n  const handleSelectAll = () => {\r\n    let selectedRowsArr = selectedRows\r\n    if (selectedRowsArr.length < data.length) {\r\n      const ids = data.map(i => i.id)\r\n      selectedRowsArr = ids\r\n    } else if (selectedRowsArr.length === data.length) {\r\n      selectedRowsArr = []\r\n    } else {\r\n      return null\r\n    }\r\n\r\n    setSelectedRows(selectedRowsArr)\r\n  }\r\n\r\n  const array = value ? filteredData : data\r\n  const renderTableData = array.map(col => {\r\n    return (\r\n      <tr\r\n        key={col.id}\r\n        className={classnames({\r\n          selected: selectedRows.includes(col.id)\r\n        })}\r\n      >\r\n        <td>\r\n          <div className='form-check'>\r\n            <Input\r\n              id={col.id}\r\n              type='checkbox'\r\n              onChange={() => handleSelect(col.id)}\r\n              checked={!!selectedRows.includes(col.id)}\r\n            />\r\n          </div>\r\n        </td>\r\n        <td>{col.email}</td>\r\n        <td>{col.name}</td>\r\n        <td>{col.website}</td>\r\n        <td>{col.id}</td>\r\n      </tr>\r\n    )\r\n  })\r\n\r\n  return (\r\n    <Fragment>\r\n      <ExtensionsHeader\r\n        title='XLSX'\r\n        subTitle='Xlsx is a parser and writer for various spreadsheet formats'\r\n        link='https://github.com/SheetJS/sheetjs'\r\n      />\r\n      <Row className='export-component'>\r\n        <Col sm='12'>\r\n          <Card>\r\n            <CardBody className='pb-0'>\r\n              <div className='d-flex flex-wrap justify-content-between'>\r\n                <Button color='primary' onClick={() => toggleModal()}>\r\n                  Export Selected\r\n                </Button>\r\n                <div className='d-flex align-items-center justify-content-end'>\r\n                  <Label for='search-input' className='me-1'>\r\n                    Search\r\n                  </Label>\r\n                  <Input id='search-input' bsSize='sm' type='text' value={value} onChange={e => handleFilter(e)} />\r\n                </div>\r\n              </div>\r\n            </CardBody>\r\n            <Table className='table-hover-animation mt-2' responsive>\r\n              <thead>\r\n                <tr>\r\n                  <th>\r\n                    <div className='form-check'>\r\n                      <Input\r\n                        type='checkbox'\r\n                        id='select-all'\r\n                        label=''\r\n                        checked={!!selectedRows.length}\r\n                        onChange={() => handleSelectAll()}\r\n                      />\r\n                    </div>\r\n                  </th>\r\n                  <th>Email</th>\r\n                  <th>Name</th>\r\n                  <th>Website</th>\r\n                  <th>Rank</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>{renderTableData}</tbody>\r\n            </Table>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <Modal\r\n        isOpen={modal}\r\n        toggle={() => toggleModal()}\r\n        className='modal-dialog-centered'\r\n        onClosed={() => setFileName('')}\r\n      >\r\n        <ModalHeader toggle={() => toggleModal()}>Export To Excel</ModalHeader>\r\n        <ModalBody>\r\n          <div className='mb-2'>\r\n            <Input\r\n              type='text'\r\n              value={fileName}\r\n              onChange={e => setFileName(e.target.value)}\r\n              placeholder='Enter File Name'\r\n            />\r\n          </div>\r\n          <div>\r\n            <Input\r\n              type='select'\r\n              id='selectFileFormat'\r\n              name='customSelect'\r\n              value={fileFormat}\r\n              onChange={e => {\r\n                setFileFormat(e.target.value)\r\n              }}\r\n            >\r\n              <option>xlsx</option>\r\n              <option>csv</option>\r\n              <option>txt</option>\r\n            </Input>\r\n          </div>\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button color='primary' onClick={() => handleExport()}>\r\n            Export\r\n          </Button>\r\n          <Button color='flat-danger' onClick={() => toggleModal()}>\r\n            Cancel\r\n          </Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default ExportSelected\r\n"]},"metadata":{},"sourceType":"module"}